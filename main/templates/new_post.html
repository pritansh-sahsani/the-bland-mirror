{% extends "layout.html" %}

{% block title %}
    New Post
{% endblock %}

{% block main %}

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script type=text/javascript>
    
    function raise_error() {
        {% if post_form.content.errors %} 
            {% for error in post_form.content.errors %}
                $("#flash_text").text("{{error}}");
                $("#flash_text_div").show();
            {% endfor %}
        {% endif %}
        
        {% if post_form.title.errors %} 
            {% for error in post_form.title.errors %}
                $("#flash_text").text("{{error}}");
                $("#flash_text_div").show();
            {% endfor %}
        {% endif %}
        
        {% if post_form.summary.errors %} 
            {% for error in post_form.summary.errors %}
                $("#flash_text").text("{{error}}");
                $("#flash_text_div").show();
            {% endfor %}
        {% endif %}
        
        {% if post_form.cover_img.errors %} 
            {% for error in post_form.cover_img.errors %}
                $("#flash_text").text("{{error}}");
                $("#flash_text_div").show();
            {% endfor %}
        {% endif %}

        {% if post_form.related_1.errors %} 
            {% for error in post_form.related_1.errors %}
                $("#flash_text").text("{{error}}");
                $("#flash_text_div").show();
            {% endfor %}
        {% endif %}
        
        {% if post_form.related_2.errors %} 
            {% for error in post_form.related_2.errors %}
                $("#flash_text").text("{{error}}");
                $("#flash_text_div").show();
            {% endfor %}
        {% endif %}
        
        {% if post_form.related_3.errors %} 
            {% for error in post_form.related_3.errors %}
                $("#flash_text").text("{{error}}");
                $("#flash_text_div").show();
            {% endfor %}
        {% endif %}

    }
    setInterval('raise_error()', 1);
</script>

    <form action="{{ url_for('create_post') }}", method="POST" class="w-80% mx-auto mt-6"  enctype="multipart/form-data">
        {{ post_form.hidden_tag() }}
        
        {{ post_form.content(id="blog_post") }}
        {{ post_form.title() }} 
        {{ post_form.summary() }} 
        {{ post_form.cover_img() }}
        {{ post_form.related_1() }} 
        {{ post_form.related_2() }} 
        {{ post_form.related_3() }}
        {{ post_form.is_draft() }}
        <label for="is_draft">Save as Draft</label> 
        {{ post_form.submit(class="my-5 w-20% h-14 ml-40% bg-blue-400 text-white rounded-lg text-2xl") }}
    </form>
    <script>
        tinymce.init({
            selector: '#blog_post',
            plugins: 'lists advlist link image codesample charmap',
            toolbar: 'undo redo removeformat | bold italic underline superscript subscript | fontfamily fontsizeinput | forecolor | numlist bullist | alignleft aligncenter alignright alignjustify | outdent indent | codesample blockquote charmap link | image',
            menubar: false,
            toolbar_sticky: true,
        });
    </script>
{% endblock %}